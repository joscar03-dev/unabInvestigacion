var InitApp=function(){var t={userrequest:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:"/admin/solicitudes-de-registro-externo".proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){delete t.columns,t.handler="Datatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Apellido Paterno",data:"paternalSurname"},{title:"Apellido Materno",data:"maternalSurname"},{title:"Nombre",data:"name"},{title:"Dni",data:"dni"},{title:"Correo",data:"email"},{title:"Estado",data:"stateText"},{title:"Tipo",data:"typeText"},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return 1!=t.state||t.hasLogged||(e+="<button type='button' ",e+="class='btn btn-primary btn-send-email ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='flaticon-multimedia-3'></i></button> "),0==t.state&&(e+="<button type='button' ",e+="class='btn btn-primary btn-accept ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-check'></i></button> ",e+="<button type='button' ",e+="class='btn btn-brand btn-reject ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-remove'></i></button> "),0!=t.state&&2!=t.state||(e+="<button type='button' ",e+="class='btn btn-danger btn-delete ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-trash'></i></button> "),e}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#data-table").DataTable(this.options),this.events()},events:function(){$("#data-table").on("click",".btn-send-email",(function(){var e=$(this);let n=$(this).data("id");e.addLoader(),$.ajax({url:"/admin/solicitudes-de-registro-externo?handler=UserRequestReSendEmail".proto().parseURL(),type:"POST",data:{id:n},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())}}).done((function(n){let a=_app.constants.toastr.message.success.task;null!=n&&""!=n&&(a=n),toastr.success(a,_app.constants.toastr.title.success),t.userrequest.reload(),e.removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),e.removeLoader()})).always((function(){}))})),$("#data-table").on("click",".btn-accept",(function(){var e=$(this);let n=$(this).data("id");e.addLoader(),$.ajax({url:"/admin/solicitudes-de-registro-externo?handler=UserRequestAccept".proto().parseURL(),type:"POST",data:{id:n},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())}}).done((function(n){let a=_app.constants.toastr.message.success.task;null!=n&&""!=n&&(a=n),toastr.success(a,_app.constants.toastr.title.success),t.userrequest.reload(),e.removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),e.removeLoader()})).always((function(){}))})),$("#data-table").on("click",".btn-delete",(function(){let e=$(this).data("id");swal({title:"¿Está seguro?",text:"La solicitud será eliminada",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarla",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((n=>{$.ajax({url:"/admin/solicitudes-de-registro-externo?handler=UserRequestDelete".proto().parseURL(),type:"POST",data:{id:e},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(e){swal({type:"success",title:"Completado",text:"La solicitud ha sido eliminada con exito",confirmButtonText:"Excelente"}).then(t.userrequest.reload())},error:function(t){let e="La solicitud presenta información relacionada";null!=t.responseText&&""!=t.responseText&&(e=t.responseText),swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:e})}})})),allowOutsideClick:()=>!swal.isLoading()})})),$("#data-table").on("click",".btn-reject",(function(){let e=$(this).data("id");swal({title:"¿Está seguro?",text:"La solicitud sera rechazada",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, rechazarla",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((n=>{$.ajax({url:"/admin/solicitudes-de-registro-externo?handler=UserRequestReject".proto().parseURL(),type:"POST",data:{id:e},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(e){swal({type:"success",title:"Completado",text:"La solicitud ha sido rechazada con exito",confirmButtonText:"Excelente"}).then(t.userrequest.reload())},error:function(t){let e="La solicitud presenta información relacionada";null!=t.responseText&&""!=t.responseText&&(e=t.responseText),swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:e})}})})),allowOutsideClick:()=>!swal.isLoading()})}))}},init:function(){this.userrequest.init()}},e={sendInvitation:{object:$("#send-invitation-form").validate({submitHandler:function(n,a){$("#btnSend").addLoader(),a.preventDefault(),$.ajax({url:$(n).attr("action"),type:"POST",data:$(n).serialize()}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),t.userrequest.reload(),e.sendInvitation.clear(),$("#btnSend").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSend").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSend").removeLoader(),$("#sendInvitationModal").modal("toggle")},clear:function(){e.sendInvitation.object.resetForm()},events:function(){$("#sendInvitationModal").on("hidden.bs.modal",(function(){e.sendInvitation.clear()}))}},init:function(){this.sendInvitation.events()}},n=function(){$("#search").doneTyping((function(){t.userrequest.reload()}))};return{init:function(){t.init(),n()}}}();$((function(){InitApp.init()}));