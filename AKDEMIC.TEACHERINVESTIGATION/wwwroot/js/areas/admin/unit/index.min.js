var InitApp=function(){var t={unit:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:"/admin/unidades".proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="Datatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Nombre",data:"name"},{title:"Usuario",data:"fullName"},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-info ",e+="m-btn btn-sm m-btn--icon btn-edit' ",e+=" data-id='"+t.id+"'>",e+="<span><i class='la la-edit'></i><span>Editar</span></span></button> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#data-table").DataTable(this.options),this.events()},events:function(){$("#data-table").on("click",".btn-edit",(function(){var t=$(this).data("id");n.unit.edit.show(t)}))}},init:function(){this.unit.init()}},e=function(){$("#search").doneTyping((function(){t.unit.reload()}))},n={unit:{edit:{object:$("#edit-form").validate({submitHandler:function(e,a){$("#btnEdit").addLoader(),a.preventDefault();let i=new FormData(e);$.ajax({url:$(e).attr("action"),type:"POST",data:i,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),t.unit.reload(),n.unit.edit.clear(),$("#btnEdit").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEdit").removeLoader()})).always((function(){}))}}),load:function(t){$.ajax({url:"/admin/unidades".proto().parseURL(),type:"GET",data:{handler:"DetailUnit",Id:t}}).done((function(t){$("#edit-form input[name=UserId]").val(t.userId),$("#UserIdHidden").val(t.userId),$("#edit-form input[name=Id]").val(t.id),$("#btnEdit").removeLoader()})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),$("#btnEdit").removeLoader()})).always((function(){}))},show:function(t){$("#btnEdit").removeLoader(),n.unit.edit.load(t),$("#editModal").modal("toggle")},clear:function(){n.unit.edit.object.resetForm()},events:function(){$("#editModal").on("hidden.bs.modal",(function(){n.unit.edit.clear()}))}},init:function(){this.edit.events()}},init:function(){this.unit.init()}},a={init:function(){this.user.init()},user:{init:function(){$("#edit-form select[name=UserId]").select2({width:"100%",dropdownParent:$("#editModal"),allowClear:!0,placeholder:"Buscar...",ajax:{url:"/api/usuarios/select-search".proto().parseURL(),dataType:"json",data:function(t){return{userType:0,term:t.term,page:t.page}},processResults:function(t,e){return{results:t}},cache:!0},escapeMarkup:function(t){return t},minimumInputLength:3})}}};return{init:function(){t.init(),e(),a.init(),n.init()}}}();$((function(){InitApp.init()}));