var index=function(){var t=$("#IncubatorConvocation_Id").val(),e=`/unidad-emprendimiento/convocatorias-emprendimiento/${t}/rubrica`,i={rubric:{object:$("#rubric_container"),reload:function(){mApp.block(i.rubric.object,{message:"Cargando rúbrica..."}),$.ajax({url:`${e}?handler=RubricPartialView`,type:"GET"}).done((function(t){i.rubric.object.html(t)}))},events:{onImport:function(){$("#btn_import_rubric").on("click",(function(){o.import.import.show()}))},onAddSection:function(){$("#btn_add_section").on("click",(function(){o.section.add.show()}))},onEditSection:function(){i.rubric.object.on("click",".edit-section",(function(){var t=$(this).data("id"),e=$(this).data("title"),i=$(this).data("maxsectionscore");o.section.edit.show(t,e,i)}))},onDeleteSection:function(){i.rubric.object.on("click",".delete-section",(function(){var t=$(this).data("id");swal({type:"warning",title:"Eliminará la sección seleccionada.",text:"¿Seguro que desea eliminarla?",confirmButtonText:"Sí",showCancelButton:!0,showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((()=>{$.ajax({type:"POST",url:`${e}?handler=DeleteSection&id=${t}`,beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())}}).done((function(){i.rubric.reload(),swal({type:"success",title:"Completado",text:"Sección eliminada satisfactoriamente.",confirmButtonText:"Aceptar"})})).fail((function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:502===t.status?"No hay respuesta del servidor":t.responseText})}))}))})}))},onAddCriterion:function(){i.rubric.object.on("click",".add-criterion",(function(){var t=$(this).data("id");o.criterion.add.show(t)}))},onEditCriterion:function(){i.rubric.object.on("click",".edit-criterion",(function(){var t=$(this).data("id"),e=$(this).data("description"),i=$(this).data("name");o.criterion.edit.show(t,i,e)}))},onDeleteCriterion:function(){i.rubric.object.on("click",".delete-criterion",(function(){var t=$(this).data("id");swal({type:"warning",title:"Eliminará el criterio seleccionado.",text:"¿Seguro que desea eliminarlo?.",confirmButtonText:"Sí",showCancelButton:!0,showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((()=>{$.ajax({type:"POST",url:`${e}?handler=DeleteCriterion&id=${t}`,beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())}}).done((function(){i.rubric.reload(),swal({type:"success",title:"Completado",text:"Criterio eliminado satisfactoriamente.",confirmButtonText:"Aceptar"})})).fail((function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:502===t.status?"No hay respuesta del servidor":t.responseText})}))}))})}))},onAddLevel:function(){i.rubric.object.on("click",".add-level",(function(){var t=$(this).data("id");o.level.add.show(t)}))},onEditLevel:function(){i.rubric.object.on("click",".edit-level",(function(){var t=$(this).data("id"),e=$(this).data("description"),i=$(this).data("score");o.level.edit.show(t,e,i)}))},onDeleteLevel:function(){i.rubric.object.on("click",".delete-level",(function(){var t=$(this).data("id");swal({type:"warning",title:"Eliminará el nivel de desempeño seleccionado.",text:"¿Seguro que desea eliminarlo?.",confirmButtonText:"Sí",showCancelButton:!0,showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((()=>{$.ajax({type:"POST",url:`${e}?handler=DeleteLevel&id=${t}`,beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())}}).done((function(){i.rubric.reload(),swal({type:"success",title:"Completado",text:"Nivel de desempeño eliminado satisfactoriamente.",confirmButtonText:"Aceptar"})})).fail((function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:502===t.status?"No hay respuesta del servidor":t.responseText})}))}))})}))},init:function(){this.onImport(),this.onAddSection(),this.onEditSection(),this.onDeleteSection(),this.onAddCriterion(),this.onEditCriterion(),this.onDeleteCriterion(),this.onAddLevel(),this.onEditLevel(),this.onDeleteLevel()}},init:function(){this.reload(),this.events.init()}},init:function(){i.rubric.init()}},o={import:{object:$("#rubric_import_modal"),form:{object:$("#rubric_import_form").validate({ignore:":hidden, [contenteditable='true']:not([name])",submitHandler:function(e,n){var r=new FormData(e);r.append("ConvocationId",t),o.import.object.find("button[type='submit']").addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0),$.ajax({url:$(e).attr("action"),type:"POST",data:r,contentType:!1,processData:!1}).done((function(t){o.import.object.modal("hide"),i.rubric.reload(),toastr.success("Tarea realizada con éxito","Hecho")})).fail((function(t){toastr.error(t.responseText,"Error!")})).always((function(){o.import.object.find("button[type='submit']").removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1)}))}})},import:{show:function(){$("#rubric_import_form").attr("action",`${e}?handler=Import`),o.import.object.find(".modal-title").text("Importar"),o.import.object.modal("show")}},events:{onHidden:function(){o.import.object.on("hidden.bs.modal",(function(){o.import.form.object.resetForm()}))},init:function(){this.onHidden()}},init:function(){this.events.init()}},section:{object:$("#rubric_section_modal"),form:{object:$("#rubric_section_form").validate({ignore:":hidden, [contenteditable='true']:not([name])",submitHandler:function(e,n){var r=new FormData(e);r.append("ConvocationId",t),o.section.object.find("button[type='submit']").addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0),$.ajax({url:$(e).attr("action"),type:"POST",data:r,contentType:!1,processData:!1}).done((function(t){o.section.object.modal("hide"),i.rubric.reload(),toastr.success("Tarea realizada con éxito","Hecho")})).fail((function(t){toastr.error(t.responseText,"Error!")})).always((function(){o.section.object.find("button[type='submit']").removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1)}))}})},add:{show:function(){$("#rubric_section_form").attr("action",`${e}?handler=AddSection`),o.section.object.find(".modal-title").text("Agregar Sección"),o.section.object.modal("show")}},edit:{show:function(t,i,n){$("#rubric_section_form").attr("action",`${e}?handler=EditSection`),o.section.object.find(".modal-title").text("Editar Sección"),o.section.object.modal("show"),o.section.object.find("[name='Id']").val(t),o.section.object.find("[name='Title']").val(i),o.section.object.find("[name='MaxSectionScore']").val(n)}},events:{onHidden:function(){o.section.object.on("hidden.bs.modal",(function(){o.section.form.object.resetForm()}))},init:function(){this.onHidden()}},init:function(){this.events.init()}},criterion:{object:$("#rubric_criterion_modal"),form:{object:$("#rubric_criterion_form").validate({ignore:":hidden, [contenteditable='true']:not([name])",submitHandler:function(e,n){var r=new FormData(e);r.append("ConvocationId",t),o.criterion.object.find("button[type='submit']").addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0),$.ajax({url:$(e).attr("action"),type:"POST",data:r,contentType:!1,processData:!1}).done((function(t){o.criterion.object.modal("hide"),i.rubric.reload(),toastr.success("Tarea realizada con éxito","Hecho")})).fail((function(t){toastr.error(t.responseText,"Error!")})).always((function(){o.criterion.object.find("button[type='submit']").removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1)}))}})},add:{show:function(t){$("#rubric_criterion_form").attr("action",`${e}?handler=AddCriterion`),o.criterion.object.find("[name='RubricSectionId']").val(t),o.criterion.object.find(".modal-title").text("Agregar Criterio"),n.init(),o.criterion.object.modal("show")}},edit:{show:function(t,i,a){$("#rubric_criterion_form").attr("action",`${e}?handler=EditCriterion`),o.criterion.object.find(".modal-title").text("Editar Criterio"),n.init(),o.criterion.object.modal("show"),o.criterion.object.find("[name='Id']").val(t),r.criterion_description.object.summernote("code",a),o.criterion.object.find("[name='Name']").val(i)}},events:{onHidden:function(){o.criterion.object.on("hidden.bs.modal",(function(){o.criterion.form.object.resetForm(),r.criterion_description.events.clean()}))},init:function(){this.onHidden()}},init:function(){this.events.init()}},level:{object:$("#level_criterion_modal"),form:{object:$("#level_criterion_form").validate({submitHandler:function(e,n){var r=new FormData(e);r.append("ConvocationId",t),o.level.object.find("button[type='submit']").addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0),$.ajax({url:$(e).attr("action"),type:"POST",data:r,contentType:!1,processData:!1}).done((function(t){o.level.object.modal("hide"),i.rubric.reload(),toastr.success("Tarea realizada con éxito","Hecho")})).fail((function(t){toastr.error(t.responseText,"Error!")})).always((function(){o.level.object.find("button[type='submit']").removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1)}))}})},add:{show:function(t){$("#level_criterion_form").attr("action",`${e}?handler=AddLevel`),o.level.object.find("[name='RubricCriterionId']").val(t),o.level.object.find(".modal-title").text("Agregar Nivel Desempeño"),o.level.object.modal("show")}},edit:{show:function(t,i,n){$("#level_criterion_form").attr("action",`${e}?handler=EditLevel`),o.level.object.find(".modal-title").text("Editar Nivel Desempeño"),o.level.object.modal("show"),o.level.object.find("[name='Id']").val(t),o.level.object.find("[name='Score']").val(n),o.level.object.find("[name='Description']").val(i)}},events:{onHidden:function(){o.level.object.on("hidden.bs.modal",(function(){o.level.form.object.resetForm()}))},init:function(){this.onHidden()}},init:function(){this.events.init()}},init:function(){o.section.init(),o.criterion.init(),o.level.init()}},n={init:function(){window.scrollTo({top:0,left:0,behavior:"smooth"})}},r={options:{height:250,toolbar:[["style",["bold","italic","underline"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]]]},criterion_description:{object:null,events:{clean:function(){r.criterion_description.object.summernote("code","")}},init:function(){this.object=$("#criterion_description_summernote").summernote(r.options)}},init:function(){this.criterion_description.init()}};return{init:function(){i.init(),r.init(),o.init()}}}();$((()=>{index.init()}));