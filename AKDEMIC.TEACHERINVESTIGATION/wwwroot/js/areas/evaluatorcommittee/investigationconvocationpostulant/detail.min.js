var InitApp=function(){var t=$("#Input_InvestigationConvocationPostulantId").val(),e=function(){$("#requestDocument").on("click",(function(){$("#requestDocument").addLoader(),$.ajax({url:`/comite-evaluador/postulaciones/${t}/detalle?handler=RequestDocument`.proto().parseURL(),type:"GET"}).done((function(){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),window.location.href=window.location.href})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#requestDocument").removeLoader()})).always((function(){}))}))},a=function(){$("#resolution-form").validate({submitHandler:function(t,e){let a=e.originalEvent.submitter;e.preventDefault();let n=new FormData(t);$(a).addLoader(),"accept"===$(a).data("id")?swal({title:"¿Está seguro?",text:"El estado de la postulación cambiará a Aceptado.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, cambiarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((t=>{$.ajax({url:$(a).attr("formaction"),type:"POST",data:n,contentType:!1,processData:!1,success:function(t){swal({type:"success",title:"Completado",text:"El estado de la postulación ha sido cambiado con exito",confirmButtonText:"Excelente"}),window.location.href=window.location.href},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:t.responseText})}})})),allowOutsideClick:()=>!swal.isLoading()}):"reject"===$(a).data("id")&&swal({title:"¿Está seguro?",text:"El estado de la postulación cambiará a Rechazado.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, cambiarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((t=>{$.ajax({url:$(a).attr("formaction"),type:"POST",data:n,contentType:!1,processData:!1,success:function(t){swal({type:"success",title:"Completado",text:"El estado de la postulación ha sido cambiado con exito",confirmButtonText:"Excelente"}),window.location.href=window.location.href},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"No se ha podido cambiar el estado de la postulación"})}})})),allowOutsideClick:()=>!swal.isLoading()}),$(a).removeLoader()}})},n={observation:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/comite-evaluador/postulaciones/${t}/detalle`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="ObservationsDatatable"}},pageLength:50,orderable:[],columns:[{title:"Fecha de Observación",data:"createdAt"},{title:"Descripción",data:"description"},{title:"Estado",data:null,render:function(t){switch(t.state){case 0:return`<span class="m--font-warning">${t.stateText}</span>`;case 1:return`<span class="m--font-info">${t.stateText}</span>`;case 2:return`<span class="m--font-danger">${t.stateText}</span>`;case 3:return`<span class="m--font-success">${t.stateText}</span>`;default:return`<span class="m--font-primary">${t.stateText}</span>`}}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#observation-table").DataTable(this.options)}},annexedFiles:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/comite-evaluador/postulaciones/${t}/detalle`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="AnnexedFileDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Nombre de Anexo",data:"name"},{title:"Fecha de Subida",data:"createdAt"},{title:"Archivo",data:null,orderable:!1,render:function(t){var e="";return e+=`<a href="${`/documentos/${t.documentPath}`.proto().parseURL()}"  `,e+="class='btn btn-success ",e+="m-btn btn-sm m-btn--icon' download>",e+="<span><i class='flaticon-file'></i></span></a> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#annexedFile-datatable").DataTable(this.options),this.events()},events:function(){$("#annexedFile-datatable").on("click",".btn-delete",(function(){var t=$(this).data("id");modal.annexedFiles.delete(t)}))}},techFiles:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/comite-evaluador/postulaciones/${t}/detalle`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="TechnicalFileDatatable"}},pageLength:50,orderable:[],columns:[{title:"Nombre de Documento Tecnico",data:"name"},{title:"Fecha de Subida",data:"createdAt"},{title:"Archivo",data:null,orderable:!1,render:function(t){var e="";return e+=`<a href="${`/documentos/${t.filePath}`.proto().parseURL()}"  `,e+="class='btn btn-success ",e+="m-btn btn-sm m-btn--icon' download>",e+="<span><i class='flaticon-file'></i></a> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#postulanttechnicalfile-datatable").DataTable(this.options)}},financialFiles:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/comite-evaluador/postulaciones/${t}/detalle`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="FinancialFileDatatable"}},pageLength:50,orderable:[],columns:[{title:"Nombre de Documento Financiero",data:"name"},{title:"Fecha de Subida",data:"createdAt"},{title:"Archivo",data:null,orderable:!1,render:function(t){var e="";return e+=`<a href="${`/documentos/${t.filePath}`.proto().parseURL()}"  `,e+="class='btn btn-success ",e+="m-btn btn-sm m-btn--icon' download>",e+="<span><i class='flaticon-file'></i></a> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#postulantfinancialfile-datatable").DataTable(this.options)}},init:function(){this.observation.init(),this.annexedFiles.init(),this.techFiles.init(),this.financialFiles.init()}};return{init:function(){e(),a(),n.init()}}}();$((function(){InitApp.init()}));