var InitApp=function(){var t=$("#Input_Id").val(),e={author:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/investigador/congresos/${t}/editar`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="AuthorDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Apellido Paterno",data:"paternalSurname"},{title:"Apellido Materno",data:"maternalSurname"},{title:"Nombres",data:"name"},{title:"Correo",data:"email"},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-info ",e+="m-btn btn-sm m-btn--icon btn-edit' ",e+=" data-id='"+t.id+"'>",e+="<span><i class='la la-edit'></i><span>Editar</span></span></button> ",e+="<button ",e+="class='btn btn-danger btn-delete ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-trash'></i></button> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#author-datatable").DataTable(this.options),this.events()},events:function(){$("#author-datatable").on("click",".btn-edit",(function(){var t=$(this).data("id");a.author.edit.show(t)})),$("#author-datatable").on("click",".btn-delete",(function(){var t=$(this).data("id");a.author.delete(t)}))}},file:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/investigador/congresos/${t}/editar`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="FileDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Name",data:"name"},{title:"Archivo",data:null,orderable:!1,render:function(t){var e="";return e+=`<a href="${`/documentos/${t.filePath}`.proto().parseURL()}"  `,e+="class='btn btn-success ",e+="m-btn btn-sm m-btn--icon' download>",e+="<span><i class='flaticon-file'></i></a> "}},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-info ",e+="m-btn btn-sm m-btn--icon btn-edit' ",e+=" data-id='"+t.id+"'>",e+="<span><i class='la la-edit'></i><span>Editar</span></span></button> ",e+="<button ",e+="class='btn btn-danger btn-delete ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-trash'></i></button> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#file-datatable").DataTable(this.options),this.events()},events:function(){$("#file-datatable").on("click",".btn-edit",(function(){var t=$(this).data("id");a.file.edit.show(t)})),$("#file-datatable").on("click",".btn-delete",(function(){var t=$(this).data("id");a.file.delete(t)}))}},init:function(){this.author.init(),this.file.init()}},a={author:{create:{object:$("#author-form").validate({submitHandler:function(t,n){$("#btnSaveAuthor").addLoader(),n.preventDefault();let o=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:o,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.author.reload(),a.author.create.clear(),$("#btnSaveAuthor").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSaveAuthor").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSaveAuthor").removeLoader(),$("#authorModal").modal("toggle")},clear:function(){a.author.create.object.resetForm()},events:function(){$("#authorModal").on("hidden.bs.modal",(function(){a.author.create.clear()}))}},edit:{object:$("#author-editform").validate({submitHandler:function(t,n){$("#btnEditAuthor").addLoader(),n.preventDefault();let o=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:o,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.author.reload(),a.author.edit.clear(),$("#btnEditAuthor").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEditAuthor").removeLoader()})).always((function(){}))}}),load:function(e){$.ajax({url:`/investigador/congresos/${t}/editar`.proto().parseURL(),type:"GET",data:{handler:"DetailAuthor",Id:e}}).done((function(t){$("#author-editform input[name=PaternalSurname]").val(t.paternalSurname),$("#author-editform input[name=MaternalSurname]").val(t.maternalSurname),$("#author-editform input[name=Name]").val(t.name),$("#author-editform input[name=Email]").val(t.email),$("#author-editform input[name=Id]").val(t.id),$("#btnEditAuthor").removeLoader()})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),$("#btnEditAuthor").removeLoader()})).always((function(){}))},show:function(t){$("#btnEditAuthor").removeLoader(),a.author.edit.load(t),$("#authorEditModal").modal("toggle")},clear:function(){a.author.edit.object.resetForm()},events:function(){$("#authorEditModal").on("hidden.bs.modal",(function(){a.author.edit.clear()}))}},delete:function(a){swal({title:"¿Está seguro?",text:"El Autor será eliminado.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((n=>{$.ajax({url:`/investigador/congresos/${t}/editar?handler=DeleteAuthor`.proto().parseURL(),type:"POST",data:{id:a},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(t){swal({type:"success",title:"Completado",text:"El Autor ha sido eliminada con exito",confirmButtonText:"Excelente"}).then(e.author.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"El Autor presenta información relacionada"})}})})),allowOutsideClick:()=>!swal.isLoading()})},init:function(){this.create.events(),this.edit.events()}},file:{create:{object:$("#file-form").validate({submitHandler:function(t,n){$("#btnSaveFile").addLoader(),n.preventDefault();let o=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:o,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.file.reload(),a.file.create.clear,$("#btnSaveFile").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSaveFile").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSaveFile").removeLoader(),$("#fileModal").modal("toggle")},clear:function(){a.file.create.object.resetForm(),$("#file-form").find(".custom-file-label").text("Seleccionar archivo")},events:function(){$("#fileModal").on("hidden.bs.modal",(function(){a.file.create.clear()}))}},edit:{object:$("#file-editform").validate({submitHandler:function(t,n){$("#btnEditFile").addLoader(),n.preventDefault();let o=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:o,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.file.reload(),a.file.edit.clear()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEditFile").removeLoader()})).always((function(){}))}}),load:function(e){$.ajax({url:`/investigador/congresos/${t}/editar`.proto().parseURL(),type:"GET",data:{handler:"DetailFile",id:e}}).done((function(t){$("#file-editform input[name=Id]").val(t.id),$("#file-editform input[name=Name]").val(t.name),$("#file-editform input[name=ConferenceId]").val(t.conferenceId),$("#file-editform").find(".custom-file-label").text("Seleccionar archivo"),$("#file-editform").find(".custom-file").append('<div class="form-control-feedback">*Seleccionar en caso sea necesario reemplazar el documento vigente.</div>')})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),null!==t.responseText&&""!==t.responseText?$("#add_form_msg_txt").html(t.responseText):$("#add_form_msg_txt").html(_app.constants.ajax.message.error),$("#add_form_msg").removeClass("m--hide").show()})).always((function(){}))},show:function(t){$("#btnEditFile").removeLoader(),a.file.edit.load(t),$("#fileEditModal").modal("toggle")},clear:function(){a.file.edit.object.resetForm()},events:function(){$("#fileEditModal").on("hidden.bs.modal",(function(){a.file.edit.clear()}))}},delete:function(a){swal({title:"¿Está seguro?",text:"El Archivo será eliminado.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((n=>{$.ajax({url:`/investigador/congresos/${t}/editar?handler=DeleteFile`.proto().parseURL(),type:"POST",data:{id:a},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(t){swal({type:"success",title:"Completado",text:"El Archivo ha sido eliminado con exito",confirmButtonText:"Excelente"}).then(e.file.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"El Archivo presenta información relacionada"})}})})),allowOutsideClick:()=>!swal.isLoading()})},init:function(){this.create.events(),this.edit.events()}},init:function(){this.author.init(),this.file.init()}},n=function(){$("#edit-form").validate({submitHandler:function(t,e){$("#btnSave").addLoader(),e.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),location.href="/investigador/congresos".proto().parseURL()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSave").removeLoader()})).always((function(){}))}})},o={init:function(){this.opusType.init(),this.type.init()},type:{init:function(){$("#Input_Type").select2()}},opusType:{init:function(){this.load()},load:function(){$.ajax({url:"/api/tipo-de-obra/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_OpusTypeId").select2({data:t});var e=$("#OpusTypeId").val();$("#Input_OpusTypeId").val(e).trigger("change")}))}}},r=function(){$("#Input_StartDate").datepicker({clearBtn:!0,orientation:"bottom",format:_app.constants.formats.datepicker}),$("#Input_EndDate").datepicker({clearBtn:!0,orientation:"bottom",format:_app.constants.formats.datepicker})};return{init:function(){e.init(),n(),r(),o.init()}}}();$((function(){InitApp.init()}));