var InitApp=function(){var t=$("#Input_InvestigationProjectId").val(),e={investigationProjectTask:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="TaskDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Tarea",data:"taskName"},{title:"Usuario",data:"fullName"},{title:"Fecha",data:"createdAt"},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-info ",e+="m-btn btn-sm m-btn--icon btn-edit' ",e+=" data-id='"+t.id+"'>",e+="<span><i class='la la-edit'></i><span>Editar</span></span></button> ",e+="<button ",e+="class='btn btn-danger btn-delete ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-trash'></i></button> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#task-datatable").DataTable(this.options),this.events()},events:function(){$("#task-datatable").on("click",".btn-edit",(function(){var t=$(this).data("id");i.investigationProjectTask.edit.show(t)})),$("#task-datatable").on("click",".btn-delete",(function(){var t=$(this).data("id");i.investigationProjectTask.delete(t)}))}},investigationProjectExpense:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="ExpenseDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Descripción",data:"description"},{title:"Gasto",data:"amount"},{title:"Centro de Financiamiento",data:"financingInvestigation"},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-info ",e+="m-btn btn-sm m-btn--icon btn-edit' ",e+=" data-id='"+t.id+"'>",e+="<span><i class='la la-edit'></i><span>Editar</span></span></button> ",e+="<button ",e+="class='btn btn-danger btn-delete ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-trash'></i></button> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#expense-datatable").DataTable(this.options),this.events()},events:function(){$("#expense-datatable").on("click",".btn-edit",(function(){var t=$(this).data("id");i.investigationProjectExpense.edit.show(t)})),$("#expense-datatable").on("click",".btn-delete",(function(){var t=$(this).data("id");i.investigationProjectExpense.delete(t)}))}},investigationProjectReport:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="ReportDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Entregable",data:"name"},{title:"Fecha de Expiración",data:"expirationDate"},{title:"Archivo",data:null,orderable:!1,render:function(t){var e="";return""==t.reportUrl||null==t.reportUrl?e+="<span>Sube tu Entregable</span>":(e+=`<a href="${`/documentos/${t.reportUrl}`.proto().parseURL()}"  `,e+="class='btn btn-success ",e+="m-btn btn-sm m-btn--icon' download>",e+="<span><i class='flaticon-file'></i></a> ")}},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-accent btn-create ",e+="m-btn btn-sm m-btn--icon' ",e+=" data-id='"+t.id+"'>",e+="<span>",e+="<i class='la la-arrow-up'></i> ",e+="<span>Subir Archivo</span>",e+="</span></button>"}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#projectReport-datatable").DataTable(this.options),this.events()},events:function(){$("#projectReport-datatable").on("click",".btn-create",(function(){var t=$(this).data("id");i.investigationProjectReport.edit.show(t)}))}},investigationProjectTeamMembers:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="ProjectTeamMemberDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Miembro",data:"fullName"},{title:"Rol",data:"roleName"},{title:"CV",data:null,orderable:!1,render:function(t){var e="";return e+=`<a href="${`/documentos/${t.cvFilePath}`.proto().parseURL()}"  `,e+="class='btn btn-success ",e+="m-btn btn-sm m-btn--icon' download>",e+="<span><i class='flaticon-file'></i></a> "}},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-info ",e+="m-btn btn-sm m-btn--icon btn-edit' ",e+=" data-id='"+t.id+"'>",e+="<span><i class='la la-edit'></i><span>Editar</span></span></button> ",e+="<button ",e+="class='btn btn-danger btn-delete ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-trash'></i></button> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#teamMember-datatable").DataTable(this.options),this.events()},events:function(){$("#teamMember-datatable").on("click",".btn-edit",(function(){var t=$(this).data("id");i.investigationProjectTeamMembers.edit.show(t)})),$("#teamMember-datatable").on("click",".btn-delete",(function(){var t=$(this).data("id");i.investigationProjectTeamMembers.delete(t)}))}},investigationProjectScientificArticle:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="ProjectScientificArticleDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Titulo del Artículo Científico",data:"title"},{title:"Artículo Científico",data:null,orderable:!1,render:function(t){var e="";return e+=`<a href="${`/documentos/${t.filePath}`.proto().parseURL()}"  `,e+="class='btn btn-success ",e+="m-btn btn-sm m-btn--icon' download>",e+="<span><i class='flaticon-file'></i></a> "}},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-info ",e+="m-btn btn-sm m-btn--icon btn-edit' ",e+=" data-id='"+t.id+"'>",e+="<span><i class='la la-edit'></i><span>Editar</span></span></button> ",e+="<button ",e+="class='btn btn-danger btn-delete ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-trash'></i></button> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#scientificArticle-datatable").DataTable(this.options),this.events()},events:function(){$("#scientificArticle-datatable").on("click",".btn-edit",(function(){var t=$(this).data("id");i.investigationProjectScientificArticle.edit.show(t)})),$("#scientificArticle-datatable").on("click",".btn-delete",(function(){var t=$(this).data("id");i.investigationProjectScientificArticle.delete(t)}))}},init:function(){this.investigationProjectTask.init(),this.investigationProjectExpense.init(),this.investigationProjectReport.init(),this.investigationProjectTeamMembers.init(),this.investigationProjectScientificArticle.init()}},n=function(){$("#create-form").validate({submitHandler:function(t,e){$("#btnSaveProject").addLoader(),e.preventDefault();let n=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:n,contentType:!1,processData:!1}).done((function(t){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),$("#btnSaveProject").removeLoader(),null!=t.ganttDiagramUrl&&""!=t.ganttDiagramUrl&&($("#create-form").find(".custom-file-label").text("Seleccionar archivo"),$("#create-form").find(".custom-file").append('<div class="form-control-feedback">*Seleccionar en caso sea necesario reemplazar el documento vigente.</div>'),$("#gantt_label").html(`Diagrama de Gant <a href="/documentos/${t.ganttDiagramUrl}" title="Descargar" class="m-widget4__icon custom--document-link" download><i class="la la-download custom--document-download"></i></a>`))})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSaveProject").removeLoader()})).always((function(){}))}})},a=function(){$(".mv_summernote").summernote({lang:"es-ES",height:150,toolbar:[["style",["style"]],["font",["bold","italic","underline","strikethrough","superscript","subscript","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ol","ul","paragraph","height"]],["table",["table"]],["insert",["link","video","hr"]],["view",["undo","redo","fullscreen","codeview"]]]})},i={investigationProjectTask:{create:{object:$("#investigationProjectTask-form").validate({submitHandler:function(t,n){$("#btnSaveInvestigationProjectTask").addLoader(),n.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.investigationProjectTask.reload(),i.investigationProjectTask.create.clear(),$("#btnSaveInvestigationProjectTask").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSaveInvestigationProjectTask").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSaveInvestigationProjectTask").removeLoader(),$("#investigationProjectTaskModal").modal("toggle")},clear:function(){i.investigationProjectTask.create.object.resetForm()},events:function(){$("#investigationProjectTaskModal").on("hidden.bs.modal",(function(){i.investigationProjectTask.create.clear()}))}},edit:{object:$("#investigationProjectTask-editform").validate({submitHandler:function(t,n){$("#btnEditInvestigationProjectTask").addLoader(),n.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.investigationProjectTask.reload(),i.investigationProjectTask.edit.clear(),$("#btnEditInvestigationProjectTask").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEditInvestigationProjectTask").removeLoader()})).always((function(){}))}}),load:function(e){$.ajax({url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",data:{handler:"DetailTask",Id:e}}).done((function(t){$("#investigationProjectTask-editform input[name=Description]").val(t.description),$("#investigationProjectTask-editform input[name=Id]").val(t.id),$("#btnEditInvestigationProjectTask").removeLoader()})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),$("#btnEditInvestigationProjectTask").removeLoader()})).always((function(){}))},show:function(t){$("#btnEditInvestigationProjectTask").removeLoader(),i.investigationProjectTask.edit.load(t),$("#investigationProjectTaskEditModal").modal("toggle")},clear:function(){i.investigationProjectTask.edit.object.resetForm()},events:function(){$("#investigationProjectTaskEditModal").on("hidden.bs.modal",(function(){i.investigationProjectTask.edit.clear()}))}},delete:function(n){swal({title:"¿Está seguro?",text:"La tarea será eliminada.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarla",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((a=>{$.ajax({url:`/investigador/proyectos/${t}/detalle?handler=DeleteTask`.proto().parseURL(),type:"POST",data:{id:n},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(t){swal({type:"success",title:"Completado",text:"La tarea ha sido eliminada con exito",confirmButtonText:"Excelente"}).then(e.investigationProjectTask.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"La tarea presenta información relacionada"})}})})),allowOutsideClick:()=>!swal.isLoading()})},init:function(){this.create.events(),this.edit.events()}},investigationProjectExpense:{create:{object:$("#investigationProjectExpense-form").validate({submitHandler:function(t,n){$("#btnSaveInvestigationProjectExpense").addLoader(),n.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.investigationProjectExpense.reload(),i.investigationProjectExpense.create.clear(),$("#btnSaveInvestigationProjectExpense").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSaveInvestigationProjectExpense").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSaveInvestigationProjectExpense").removeLoader(),$("#investigationProjectExpenseModal").modal("toggle")},clear:function(){i.investigationProjectExpense.create.object.resetForm()},events:function(){$("#investigationProjectExpenseModal").on("hidden.bs.modal",(function(){i.investigationProjectExpense.create.clear()}))}},edit:{object:$("#investigationProjectExpense-editform").validate({submitHandler:function(t,n){$("#btnEditInvestigationProjectExpense").addLoader(),n.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.investigationProjectExpense.reload(),i.investigationProjectExpense.edit.clear(),$("#btnEditInvestigationProjectExpense").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEditInvestigationProjectExpense").removeLoader()})).always((function(){}))}}),load:function(e){$.ajax({url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",data:{handler:"DetailExpense",Id:e}}).done((function(t){$("#investigationProjectExpense-editform input[name=Description]").val(t.description),$("#investigationProjectExpense-editform input[name=Amount]").val(t.amount),$("#investigationProjectExpense-editform input[name=Id]").val(t.id)})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)})).always((function(){}))},show:function(t){$("#btnEditInvestigationProjectExpense").removeLoader(),i.investigationProjectExpense.edit.load(t),$("#investigationProjectExpenseEditModal").modal("toggle")},clear:function(){i.investigationProjectExpense.edit.object.resetForm()},events:function(){$("#investigationProjectExpenseEditModal").on("hidden.bs.modal",(function(){i.investigationProjectExpense.edit.clear()}))}},delete:function(n){swal({title:"¿Está seguro?",text:"El gasto será eliminado.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((a=>{$.ajax({url:`/investigador/proyectos/${t}/detalle?handler=DeleteExpense`.proto().parseURL(),type:"POST",data:{id:n},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(t){swal({type:"success",title:"Completado",text:"El gasto ha sido eliminado con exito",confirmButtonText:"Excelente"}).then(e.investigationProjectExpense.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"El gasto presenta información relacionada"})}})})),allowOutsideClick:()=>!swal.isLoading()})},init:function(){this.create.events(),this.edit.events()}},investigationProjectReport:{edit:{object:$("#investigationProjectReport-editform").validate({submitHandler:function(t,n){$("#btnEditInvestigationProjectReport").addLoader(),n.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.investigationProjectReport.reload(),i.investigationProjectReport.edit.clear(),$("#btnEditInvestigationProjectReport").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEditInvestigationProjectReport").removeLoader()})).always((function(){}))}}),load:function(e){$.ajax({url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",data:{handler:"DetailUploadprojectreportDocumentFile",Id:e}}).done((function(t){$("#investigationProjectReport-editform input[name=Id]").val(t.id),$("#investigationProjectReport-editform input[name=Name]").val(t.name),$("#investigationProjectReport-editform input[name=ExpirationDate]").val(t.expirationDate),$("#investigationProjectReport-editform").find(".custom-file-label").text("Seleccionar archivo"),$("#investigationProjectReport-editform").find(".custom-file").append('<div class="form-control-feedback">*Seleccionar en caso sea necesario reemplazar el documento vigente.</div>')})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)})).always((function(){}))},show:function(t){$("#btnEditInvestigationProjectReport").removeLoader(),i.investigationProjectReport.edit.load(t),$("#investigationProjectReportEditModal").modal("toggle")},clear:function(){$("#investigationProjectReport-editform").find(".custom-file-label").text("Seleccionar archivo"),i.investigationProjectReport.edit.object.resetForm()},events:function(){$("#investigationProjectReportEditModal").on("hidden.bs.modal",(function(){i.investigationProjectReport.edit.clear()}))}},init:function(){this.edit.events()}},investigationProjectTeamMembers:{create:{object:$("#investigationProjectTeamMember-form").validate({submitHandler:function(t,n){$("#btnSaveInvestigationProjectTeamMember").addLoader(),n.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.investigationProjectTeamMembers.reload(),i.investigationProjectTeamMembers.create.clear,$("#btnSaveInvestigationProjectTeamMember").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSaveInvestigationProjectTeamMember").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSaveInvestigationProjectTeamMember").removeLoader(),$("#investigationProjectTeamMember").modal("toggle")},clear:function(){i.investigationProjectTeamMembers.create.object.resetForm(),$("#investigationProjectTeamMember-form").find(".custom-file-label").text("Seleccionar archivo")},events:function(){$("#investigationProjectTeamMember").on("hidden.bs.modal",(function(){i.investigationProjectTeamMembers.create.clear()}))}},edit:{object:$("#investigationProjectProjectTeamMember-editform").validate({submitHandler:function(t,n){$("#btnEditInvestigationProjectTeamMember").addLoader(),n.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.investigationProjectTeamMembers.reload(),i.edit.clear()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEditInvestigationProjectTeamMember").removeLoader()})).always((function(){}))}}),load:function(e){$.ajax({url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",data:{handler:"DetailProjectTeamMembers",id:e}}).done((function(t){$("#investigationProjectProjectTeamMember-editform input[name=Id]").val(t.id),$("#investigationProjectProjectTeamMember-editform input[name=InvestigationProjectId]").val(t.investigationProjectId),$("#investigationProjectProjectTeamMember-editform input[name=FullName]").val(t.fullName),$("#investigationProjectProjectTeamMember-editform select[name=TeamMemberRoleId]").val(t.teamMemberRoleId).trigger("change"),$("#investigationProjectProjectTeamMember-editform").find(".custom-file-label").text("Seleccionar archivo"),$("#investigationProjectProjectTeamMember-editform").find(".custom-file").append('<div class="form-control-feedback">*Seleccionar en caso sea necesario reemplazar el documento vigente.</div>'),$("#investigationProjectProjectTeamMember-editform textarea[name=Objectives]").summernote("code",t.objectives)})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),null!==t.responseText&&""!==t.responseText?$("#add_form_msg_txt").html(t.responseText):$("#add_form_msg_txt").html(_app.constants.ajax.message.error),$("#add_form_msg").removeClass("m--hide").show()})).always((function(){}))},show:function(t){$("#btnEditInvestigationProjectTeamMember").removeLoader(),i.investigationProjectTeamMembers.edit.load(t),$("#investigationProjectProjectEditTeamMemberModal").modal("toggle")},clear:function(){i.investigationProjectTeamMembers.edit.object.resetForm()},events:function(){$("#investigationProjectProjectEditTeamMemberModal").on("hidden.bs.modal",(function(){i.investigationProjectTeamMembers.edit.clear()}))}},delete:function(n){swal({title:"¿Está seguro?",text:"El miembro de equipo será eliminado.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((a=>{$.ajax({url:`/investigador/proyectos/${t}/detalle?handler=DeleteProjectTeamMembers`.proto().parseURL(),type:"POST",data:{id:n},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(t){swal({type:"success",title:"Completado",text:"El miembro de equipo ha sido eliminado con exito",confirmButtonText:"Excelente"}).then(e.investigationProjectTeamMembers.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"El miembro de equipo presenta información relacionada"})}})})),allowOutsideClick:()=>!swal.isLoading()})},init:function(){this.create.events(),this.edit.events()}},investigationProjectFinalDocument:{create:{object:$("#finalDocument-form").validate({submitHandler:function(t,e){$("#btnSaveFinalDocument").addLoader(),e.preventDefault();let n=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:n,contentType:!1,processData:!1}).done((function(t){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),$("#btnSaveFinalDocument").removeLoader(),window.location.href=window.location.href})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSaveFinalDocument").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSaveFinalDocument").removeLoader(),$("#finalDocumentModal").modal("toggle")},clear:function(){i.investigationProjectFinalDocument.create.object.resetForm()},events:function(){$("#finalDocumentModal").on("hidden.bs.modal",(function(){i.investigationProjectFinalDocument.create.clear()}))}},init:function(){this.create.events()}},investigationProjectScientificArticle:{create:{object:$("#investigationProjectScientificArticle-form").validate({submitHandler:function(t,n){$("#btnSaveInvestigationProjectScientificArticle").addLoader(),n.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.investigationProjectScientificArticle.reload(),i.investigationProjectScientificArticle.create.clear,$("#btnSaveInvestigationProjectScientificArticle").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSaveInvestigationProjectScientificArticle").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSaveInvestigationProjectScientificArticle").removeLoader(),$("#investigationProjectScientificArticle").modal("toggle")},clear:function(){i.investigationProjectScientificArticle.create.object.resetForm(),$("#investigationProjectScientificArticle-form").find(".custom-file-label").text("Seleccionar archivo")},events:function(){$("#investigationProjectScientificArticle").on("hidden.bs.modal",(function(){i.investigationProjectScientificArticle.create.clear()}))}},edit:{object:$("#investigationProjectProjectScientificArticle-editform").validate({submitHandler:function(t,n){$("#btnEditInvestigationProjectScientificArticle").addLoader(),n.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.investigationProjectScientificArticle.reload(),i.edit.clear()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEditInvestigationProjectScientificArticle").removeLoader()})).always((function(){}))}}),load:function(e){$.ajax({url:`/investigador/proyectos/${t}/detalle`.proto().parseURL(),type:"GET",data:{handler:"DetailProjectScientificArticle",id:e}}).done((function(t){$("#investigationProjectProjectScientificArticle-editform input[name=Id]").val(t.id),$("#investigationProjectProjectScientificArticle-editform input[name=Title]").val(t.title),$("#investigationProjectProjectScientificArticle-editform input[name=InvestigationProjectId]").val(t.investigationProjectId),$("#investigationProjectProjectScientificArticle-editform").find(".custom-file-label").text("Seleccionar archivo"),$("#investigationProjectProjectScientificArticle-editform").find(".custom-file").append('<div class="form-control-feedback">*Seleccionar en caso sea necesario reemplazar el documento vigente.</div>')})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),null!==t.responseText&&""!==t.responseText?$("#add_form_msg_txt").html(t.responseText):$("#add_form_msg_txt").html(_app.constants.ajax.message.error),$("#add_form_msg").removeClass("m--hide").show()})).always((function(){}))},show:function(t){$("#btnEditInvestigationProjectScientificArticle").removeLoader(),i.investigationProjectScientificArticle.edit.load(t),$("#investigationProjectProjectEditScientificArticle").modal("toggle")},clear:function(){i.investigationProjectScientificArticle.edit.object.resetForm()},events:function(){$("#investigationProjectProjectEditScientificArticle").on("hidden.bs.modal",(function(){i.investigationProjectScientificArticle.edit.clear()}))}},delete:function(n){swal({title:"¿Está seguro?",text:"El Articulo Cientifico será eliminado.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((a=>{$.ajax({url:`/investigador/proyectos/${t}/detalle?handler=DeleteProjectScientificArticle`.proto().parseURL(),type:"POST",data:{id:n},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(t){swal({type:"success",title:"Completado",text:"El Articulo Cientifico ha sido eliminado con exito",confirmButtonText:"Excelente"}).then(e.investigationProjectScientificArticle.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"El Articulo Cientifico presenta información relacionada"})}})})),allowOutsideClick:()=>!swal.isLoading()})},init:function(){this.create.events(),this.edit.events()}},init:function(){this.investigationProjectTask.init(),this.investigationProjectExpense.init(),this.investigationProjectReport.init(),this.investigationProjectTeamMembers.init(),this.investigationProjectFinalDocument.init(),this.investigationProjectScientificArticle.init()}},o={init:function(){this.researcherUser.init(),this.researcherUserRole.init(),this.projectType.init()},researcherUser:{init:function(){$("#investigationProjectTeamMember-form select[name=UserId]").select2({dropdownParent:$("#investigationProjectTeamMember"),width:"100%",placeholder:"Buscar...",ajax:{url:"/api/usuarios/select-search".proto().parseURL(),dataType:"json",data:function(t){return{term:t.term,page:t.page}},processResults:function(t,e){return{results:t}},cache:!0},escapeMarkup:function(t){return t},minimumInputLength:3}),$("#investigationProjectProjectTeamMember-editform select[name=UserId]").select2({dropdownParent:$("#investigationProjectProjectEditTeamMemberModal"),width:"100%",placeholder:"Buscar...",ajax:{url:"/api/usuarios/select-search".proto().parseURL(),dataType:"json",data:function(t){return{term:t.term,page:t.page}},processResults:function(t,e){return{results:t}},cache:!0},escapeMarkup:function(t){return t},minimumInputLength:3})}},researcherUserRole:{init:function(){this.load()},load:function(){$.ajax({url:"/api/rolesinvestigacion/select/get".proto().parseURL(),type:"GET"}).done((function(t){$('#investigationProjectTeamMember-form select[name="TeamMemberRoleId"]').select2({data:t}),$('#investigationProjectProjectTeamMember-editform select[name="TeamMemberRoleId"]').select2({data:t})}))}},projectType:{init:function(){this.load()},load:function(){$("#Input_InvestigationProjectTypeId").select2(),$.ajax({url:"/api/tiposdeproyecto/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_InvestigationProjectTypeId").select2({data:t})}))}}};return{init:function(){e.init(),i.init(),o.init(),a(),n(),$("form").each((function(){$(this).data("validator")&&($(this).data("validator").settings.ignore=".note-editor *")}))}}}();$((function(){InitApp.init()}));