var InitApp=function(){var t=[],e=[],n={author:{object:null,options:{serverSide:!1,filter:!1,lengthChange:!1,data:t,columns:[{title:"Apellido Paterno",data:"paternalSurname"},{title:"Apellido Materno",data:"maternalSurname"},{title:"Nombres",data:"name"},{title:"Correo electrónico",data:"email"},{title:"Opciones",render:function(t,e){return`<button data-index="${e}" type="button" class="btn btn-danger btn-sm m-btn m-btn--icon btn-delete-author"<span><i class="la la-trash"> </i> </span> Eliminar </span></span></button>`}}]},reload:function(){this.object.clear(),this.object.rows.add(t),this.object.draw()},events:function(){$("#authors-table").on("click",".btn-delete-author",(function(){let e=$(this).data("index");t.splice(e,1),n.author.reload()}))},init:function(){this.object=$("#authors-table").DataTable(this.options),this.events()}},file:{object:null,options:{serverSide:!1,filter:!1,lengthChange:!1,data:e,columns:[{title:"Nombre",data:"name"},{title:"Tamaño",data:null,render:function(t){return function(t){if(0==t)return"0 Bytes";var e=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return Math.round(t/Math.pow(1024,e),2)+" "+["Bytes","KB","MB","GB","TB"][e]}(t.size)}},{title:"Opciones",data:null,render:function(t,e){return`<button data-index="${e}" type="button" class="btn btn-danger btn-sm m-btn m-btn--icon btn-delete-file"<span><i class="la la-trash"> </i> </span> Eliminar </span></span></button>`}}]},reload:function(){this.object.clear(),this.object.rows.add(e),this.object.draw()},events:function(){$("#files-table").on("click",".btn-delete-file",(function(){let t=$(this).data("index");e.splice(t,1),n.file.reload()}))},init:function(){this.object=$("#files-table").DataTable(this.options),this.events()}},init:function(){this.author.init(),this.file.init()}},a={author:{object:$("#add-author-form").validate({submitHandler:function(e,a){$("#btnSaveAuthor").addLoader(),a.preventDefault();let i=$("#add-author-form input[name='PaternalSurname']").val(),o=$("#add-author-form input[name='MaternalSurname']").val(),r=$("#add-author-form input[name='Name']").val(),l=$("#add-author-form input[name='Email']").val();t.push({paternalSurname:i,maternalSurname:o,name:r,email:l}),n.author.reload(),$("#btnSaveAuthor").removeLoader(),$("#add-authors-modal").modal("hide")}}),show:function(){$("#btnSaveAuthor").removeLoader(),$("#add-authors-modal").modal("toggle")},clear:function(){a.author.object.resetForm()},events:function(){$("#add-authors-modal").on("hidden.bs.modal",(function(){a.author.clear()}))},init:function(){this.events()}},file:{object:$("#add-file-form").validate({submitHandler:function(t,a){$("#btnSavefile").addLoader(),a.preventDefault();let i=$("#add-file-form input[name='Name']").val(),o=$("#add-file-form input[name='File']")[0].files[0];e.push({name:i,file:o,size:o.size}),n.file.reload(),$("#btnSavefile").removeLoader(),$("#add-files-modal").modal("hide")}}),show:function(){$("#btnSavefile").removeLoader(),$("#add-files-modal").modal("toggle")},clear:function(){$("#add-file-form input[name='File']").next().html("Seleccione archivo"),a.file.object.resetForm()},events:function(){$("#add-files-modal").on("hidden.bs.modal",(function(){a.file.clear()}))},init:function(){this.events()}},init:function(){this.author.init(),this.file.init()}},i={publication:{init:function(){$("#create-form").validate({submitHandler:function(n,a){$("#btnSave").addLoader(),a.preventDefault();let i=new FormData(n);for(var o=0;o<t.length;o++)i.append(`Input.Authors[${o}].PaternalSurname`,t[o].paternalSurname),i.append(`Input.Authors[${o}].MaternalSurname`,t[o].maternalSurname),i.append(`Input.Authors[${o}].Name`,t[o].name),i.append(`Input.Authors[${o}].Email`,t[o].email);for(o=0;o<e.length;o++)i.append(`Input.PublicationFiles[${o}].File`,e[o].file),i.append(`Input.PublicationFiles[${o}].Name`,e[o].name);$.ajax({url:$(n).attr("action"),type:"POST",data:i,contentType:!1,processData:!1}).done((function(){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),location.href="/investigador/publicaciones/crear".proto().parseURL()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSave").removeLoader()})).always((function(){}))}})}},init:function(){this.publication.init()}},o={init:function(){this.authorShipOrder.init(),this.publicationFunction.init(),this.opusType.init(),this.indexPlace.init(),this.identificationType.init(),this.workerCategory.init()},workerCategory:{init:function(){$("#Input_WorkCategory").select2()}},authorShipOrder:{init:function(){this.load()},load:function(){$.ajax({url:"/api/orden-autoria/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_AuthorShipOrderId").select2({data:t})}))}},publicationFunction:{init:function(){this.load()},load:function(){$.ajax({url:"/api/funciones/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_PublicationFunctionId").select2({data:t})}))}},opusType:{init:function(){this.load()},load:function(){$.ajax({url:"/api/tipo-de-obra/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_OpusTypeId").select2({data:t})}))}},indexPlace:{init:function(){this.load()},load:function(){$.ajax({url:"/api/indexada/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_IndexPlaceId").select2({data:t})}))}},identificationType:{init:function(){this.load()},load:function(){$.ajax({url:"/api/tipo-de-identificacion/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_IdentificationTypeId").select2({data:t})}))}}},r=function(){$("#Input_TermnConditions").on("click",(function(){$("#Input_TermnConditions").is(":checked")?$(".to_hide").attr("hidden",!1):$(".to_hide").attr("hidden",!0)}))},l=function(){$("#Input_PublishDate").datepicker({clearBtn:!0,orientation:"bottom",format:_app.constants.formats.datepicker})};return{init:function(){n.init(),i.init(),a.init(),l(),o.init(),r()}}}();$((function(){InitApp.init()}));