var InitApp=function(){var t=$("#Input_Id").val(),e={publicationAuthor:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/investigador/publicaciones/${t}/editar`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="AuthorDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Apellido Paterno",data:"paternalSurname"},{title:"Apellido Materno",data:"maternalSurname"},{title:"Nombres",data:"name"},{title:"Correo",data:"email"},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-info ",e+="m-btn btn-sm m-btn--icon btn-edit' ",e+=" data-id='"+t.id+"'>",e+="<span><i class='la la-edit'></i><span>Editar</span></span></button> ",e+="<button ",e+="class='btn btn-danger btn-delete ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-trash'></i></button> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#author-datatable").DataTable(this.options),this.events()},events:function(){$("#author-datatable").on("click",".btn-edit",(function(){var t=$(this).data("id");a.publicationAuthor.edit.show(t)})),$("#author-datatable").on("click",".btn-delete",(function(){var t=$(this).data("id");a.publicationAuthor.delete(t)}))}},publicationFile:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:`/investigador/publicaciones/${t}/editar`.proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.handler="FileDatatable",t.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{title:"Name",data:"name"},{title:"Archivo",data:null,orderable:!1,render:function(t){var e="";return e+=`<a href="${`/documentos/${t.filePath}`.proto().parseURL()}"  `,e+="class='btn btn-success ",e+="m-btn btn-sm m-btn--icon' download>",e+="<span><i class='flaticon-file'></i></a> "}},{title:"Opciones",data:null,orderable:!1,render:function(t){var e="";return e+="<button ",e+="class='btn btn-info ",e+="m-btn btn-sm m-btn--icon btn-edit' ",e+=" data-id='"+t.id+"'>",e+="<span><i class='la la-edit'></i><span>Editar</span></span></button> ",e+="<button ",e+="class='btn btn-danger btn-delete ",e+="m-btn btn-sm  m-btn--icon-only' ",e+=" data-id='"+t.id+"'>",e+="<i class='la la-trash'></i></button> "}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#file-datatable").DataTable(this.options),this.events()},events:function(){$("#file-datatable").on("click",".btn-edit",(function(){var t=$(this).data("id");a.publicationFile.edit.show(t)})),$("#file-datatable").on("click",".btn-delete",(function(){var t=$(this).data("id");a.publicationFile.delete(t)}))}},init:function(){this.publicationAuthor.init(),this.publicationFile.init()}},a={publicationAuthor:{create:{object:$("#publicationAuthor-form").validate({submitHandler:function(t,n){$("#btnSavePublicationAuthor").addLoader(),n.preventDefault();let i=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:i,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.publicationAuthor.reload(),a.publicationAuthor.create.clear(),$("#btnSavePublicationAuthor").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSavePublicationAuthor").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSavePublicationAuthor").removeLoader(),$("#publicationAuthorModal").modal("toggle")},clear:function(){a.publicationAuthor.create.object.resetForm()},events:function(){$("#publicationAuthorModal").on("hidden.bs.modal",(function(){a.publicationAuthor.create.clear()}))}},edit:{object:$("#publicationAuthor-editform").validate({submitHandler:function(t,n){$("#btnEditPublicationAuthor").addLoader(),n.preventDefault();let i=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:i,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.publicationAuthor.reload(),a.publicationAuthor.edit.clear(),$("#btnEditPublicationAuthor").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEditPublicationAuthor").removeLoader()})).always((function(){}))}}),load:function(e){$.ajax({url:`/investigador/publicaciones/${t}/editar`.proto().parseURL(),type:"GET",data:{handler:"DetailPublicationAuthor",Id:e}}).done((function(t){$("#publicationAuthor-editform input[name=PaternalSurname]").val(t.paternalSurname),$("#publicationAuthor-editform input[name=MaternalSurname]").val(t.maternalSurname),$("#publicationAuthor-editform input[name=Name]").val(t.name),$("#publicationAuthor-editform input[name=Email]").val(t.email),$("#publicationAuthor-editform input[name=Id]").val(t.id),$("#btnEditPublicationAuthor").removeLoader()})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),$("#btnEditPublicationAuthor").removeLoader()})).always((function(){}))},show:function(t){$("#btnEditPublicationAuthor").removeLoader(),a.publicationAuthor.edit.load(t),$("#publicationAuthorEditModal").modal("toggle")},clear:function(){a.publicationAuthor.edit.object.resetForm()},events:function(){$("#publicationAuthorEditModal").on("hidden.bs.modal",(function(){a.publicationAuthor.edit.clear()}))}},delete:function(a){swal({title:"¿Está seguro?",text:"El Autor será eliminado.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((n=>{$.ajax({url:`/investigador/publicaciones/${t}/editar?handler=DeletePublicationAuthor`.proto().parseURL(),type:"POST",data:{id:a},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(t){swal({type:"success",title:"Completado",text:"El Autor ha sido eliminada con exito",confirmButtonText:"Excelente"}).then(e.publicationAuthor.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"El Autor presenta información relacionada"})}})})),allowOutsideClick:()=>!swal.isLoading()})},init:function(){this.create.events(),this.edit.events()}},publicationFile:{create:{object:$("#publicationFile-form").validate({submitHandler:function(t,n){$("#btnSavePublicationFile").addLoader(),n.preventDefault();let i=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:i,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.publicationFile.reload(),a.publicationFile.create.clear,$("#btnSavePublicationFile").removeLoader()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSavePublicationFile").removeLoader()})).always((function(){}))}}),show:function(){$("#btnSavePublicationFile").removeLoader(),$("#publicationFileModal").modal("toggle")},clear:function(){a.publicationFile.create.object.resetForm(),$("#publicationFile-form").find(".custom-file-label").text("Seleccionar archivo")},events:function(){$("#publicationFileModal").on("hidden.bs.modal",(function(){a.publicationFile.create.clear()}))}},edit:{object:$("#publicationFile-editform").validate({submitHandler:function(t,n){$("#btnEditPublicationFile").addLoader(),n.preventDefault();let i=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:i,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.publicationFile.reload(),a.edit.clear()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnEditPublicationFile").removeLoader()})).always((function(){}))}}),load:function(e){$.ajax({url:`/investigador/publicaciones/${t}/editar`.proto().parseURL(),type:"GET",data:{handler:"DetailPublicationFile",id:e}}).done((function(t){$("#publicationFile-editform input[name=Id]").val(t.id),$("#publicationFile-editform input[name=Name]").val(t.name),$("#publicationFile-editform input[name=PublicationId]").val(t.publicationId),$("#publicationFile-editform").find(".custom-file-label").text("Seleccionar archivo"),$("#publicationFile-editform").find(".custom-file").append('<div class="form-control-feedback">*Seleccionar en caso sea necesario reemplazar el documento vigente.</div>')})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),null!==t.responseText&&""!==t.responseText?$("#add_form_msg_txt").html(t.responseText):$("#add_form_msg_txt").html(_app.constants.ajax.message.error),$("#add_form_msg").removeClass("m--hide").show()})).always((function(){}))},show:function(t){$("#btnEditPublicationFile").removeLoader(),a.publicationFile.edit.load(t),$("#publicationFileEditModal").modal("toggle")},clear:function(){a.publicationFile.edit.object.resetForm()},events:function(){$("#publicationFileEditModal").on("hidden.bs.modal",(function(){a.publicationFile.edit.clear()}))}},delete:function(a){swal({title:"¿Está seguro?",text:"El Archivo será eliminado.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((n=>{$.ajax({url:`/investigador/publicaciones/${t}/editar?handler=DeletePublicationFile`.proto().parseURL(),type:"POST",data:{id:a},beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(t){swal({type:"success",title:"Completado",text:"El Archivo ha sido eliminado con exito",confirmButtonText:"Excelente"}).then(e.publicationFile.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"El Archivo presenta información relacionada"})}})})),allowOutsideClick:()=>!swal.isLoading()})},init:function(){this.create.events(),this.edit.events()}},init:function(){this.publicationAuthor.init(),this.publicationFile.init()}},n=function(){$("#edit-form").validate({submitHandler:function(t,e){$("#btnSave").addLoader(),e.preventDefault();let a=new FormData(t);$.ajax({url:$(t).attr("action"),type:"POST",data:a,contentType:!1,processData:!1}).done((function(){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),location.href="/investigador/publicaciones".proto().parseURL()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error),$("#btnSave").removeLoader()})).always((function(){}))}})},i={init:function(){this.authorShipOrder.init(),this.publicationFunction.init(),this.opusType.init(),this.indexPlace.init(),this.identificationType.init(),this.workerCategory.init()},workerCategory:{init:function(){$("#Input_WorkCategory").select2()}},authorShipOrder:{init:function(){this.load()},load:function(){$.ajax({url:"/api/orden-autoria/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_AuthorShipOrderId").select2({data:t});var e=$("#AuthorShipOrderId").val();$("#Input_AuthorShipOrderId").val(e).trigger("change")}))}},publicationFunction:{init:function(){this.load()},load:function(){$.ajax({url:"/api/funciones/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_PublicationFunctionId").select2({data:t});var e=$("#PublicationFunctionId").val();$("#Input_PublicationFunctionId").val(e).trigger("change")}))}},opusType:{init:function(){this.load()},load:function(){$.ajax({url:"/api/tipo-de-obra/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_OpusTypeId").select2({data:t});var e=$("#OpusTypeId").val();$("#Input_OpusTypeId").val(e).trigger("change")}))}},indexPlace:{init:function(){this.load()},load:function(){$.ajax({url:"/api/indexada/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_IndexPlaceId").select2({data:t});var e=$("#IndexPlaceId").val();$("#Input_IndexPlaceId").val(e).trigger("change")}))}},identificationType:{init:function(){this.load()},load:function(){$.ajax({url:"/api/tipo-de-identificacion/select/get".proto().parseURL(),type:"GET"}).done((function(t){$("#Input_IdentificationTypeId").select2({data:t});var e=$("#IdentificationTypeId").val();$("#Input_IdentificationTypeId").val(e).trigger("change")}))}}},o=function(){$("#Input_PublishDate").datepicker({clearBtn:!0,orientation:"bottom",format:_app.constants.formats.datepicker})};return{init:function(){e.init(),n(),o(),i.init()}}}();$((function(){InitApp.init()}));